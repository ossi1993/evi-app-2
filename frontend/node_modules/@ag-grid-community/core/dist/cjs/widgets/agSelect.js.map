{"version":3,"sources":["../../src/ts/widgets/agSelect.ts"],"names":[],"mappings":"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","file":"agSelect.js","sourcesContent":["import { AgAbstractField } from \"./agAbstractField\";\nimport { AgPickerField } from \"./agPickerField\";\nimport { IAgLabel } from \"./agAbstractLabel\";\nimport { ListOption, AgList } from \"./agList\";\nimport { Autowired, PostConstruct } from \"../context/context\";\nimport { PopupService } from \"./popupService\";\nimport { _ } from \"../utils\";\n\ntype AgSelectConfig = ListOption & IAgLabel;\n\nexport class AgSelect extends AgPickerField<HTMLSelectElement, string> {\n\n    protected displayTag = 'div';\n    protected className = 'ag-select';\n    protected pickerIcon = 'smallDown';\n    protected listComponent: AgList;\n    private hideList: (event?: any) => void;\n\n    @Autowired('popupService') private popupService: PopupService;\n\n    constructor(config?: AgSelectConfig) {\n        super();\n        this.setTemplate(this.TEMPLATE.replace(/%displayField%/g, this.displayTag));\n    }\n\n    @PostConstruct\n    public init(): void {\n        this.listComponent = new AgList('select');\n        this.getContext().createBean(this.listComponent);\n        this.listComponent.setParentComponent(this);\n        this.eWrapper.tabIndex = 0;\n\n        this.listComponent.addManagedListener(\n            this.listComponent,\n            AgList.EVENT_ITEM_SELECTED,\n            () => { if (this.hideList) { this.hideList(); } }\n        );\n\n        this.listComponent.addManagedListener(\n            this.listComponent,\n            AgAbstractField.EVENT_CHANGED,\n            () => {\n                this.setValue(this.listComponent.getValue(), false, true);\n                if (this.hideList) { this.hideList(); }\n            }\n        );\n    }\n\n    protected showPicker() {\n        const listGui = this.listComponent.getGui();\n        const mouseWheelFunc = this.addManagedListener(document.body, 'wheel', (e: MouseEvent) => {\n            if (!listGui.contains(e.target as HTMLElement) && this.hideList) {\n                this.hideList();\n            }\n        });\n        const focusOutFunc = this.addManagedListener(listGui, 'focusout', (e: FocusEvent) => {\n            if (!listGui.contains(e.relatedTarget as HTMLElement) && this.hideList) {\n                this.hideList();\n            }\n        });\n\n        this.hideList = this.popupService.addPopup(true, listGui, true, () => {\n            this.hideList = null;\n            focusOutFunc();\n            mouseWheelFunc();\n            if (this.isAlive()) {\n                this.getFocusableElement().focus();\n            }\n        });\n\n        _.setElementWidth(listGui, _.getAbsoluteWidth(this.eWrapper));\n        listGui.style.maxHeight = _.getInnerHeight(this.popupService.getPopupParent()) + 'px';\n\n        listGui.style.position = 'absolute';\n\n        this.popupService.positionPopupUnderComponent({\n            type: 'ag-list',\n            eventSource: this.eWrapper,\n            ePopup: listGui,\n            keepWithinBounds: true\n        });\n\n        this.listComponent.refreshHighlighted();\n\n        return this.listComponent;\n    }\n\n    public addOptions(options: ListOption[]): this {\n        options.forEach((option) => this.addOption(option));\n\n        return this;\n    }\n\n    public addOption(option: ListOption): this {\n        this.listComponent.addOption(option);\n\n        return this;\n    }\n\n    public setValue(value: string, silent?: boolean, fromPicker?: boolean): this {\n        if (this.value === value) { return; }\n\n        if (!fromPicker) {\n            this.listComponent.setValue(value, true);\n        }\n\n        const newValue = this.listComponent.getValue();\n\n        if (newValue === this.getValue()) { return; }\n\n        this.eDisplayField.innerHTML = this.listComponent.getDisplayValue();\n\n        return super.setValue(value, silent);\n    }\n\n    protected destroy(): void {\n        if (this.hideList) {\n            this.hideList();\n        }\n\n        this.getContext().destroyBean(this.listComponent);\n        super.destroy();\n    }\n}\n"]}