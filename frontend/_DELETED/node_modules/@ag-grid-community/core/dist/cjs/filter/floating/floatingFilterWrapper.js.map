{"version":3,"sources":["../../src/ts/filter/floating/floatingFilterWrapper.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,iDAAkD;AAElD,gDAA+C;AAC/C,0EAAyE;AAEzE,2EAAiE;AAEjE,mEAAkE;AAClE,uCAA0D;AAE1D,qCAAsC;AAOtC,4EAA2E;AAC3E,yDAAwD;AACxD,+DAA8D;AAC9D,uCAAoE;AACpE,yCAAoD;AACpD,4FAA4F;AAC5F,6CAA4C;AAI5C;IAA2C,yCAAqB;IA2C5D,+BAAY,MAAc,EAAE,MAAc;QAA1C,YACI,kBAAM,qBAAqB,CAAC,QAAQ,CAAC,SAGxC;QAFG,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;IACzB,CAAC;IAES,6CAAa,GAAvB;QACI,iBAAM,aAAa,WAAE,CAAC;QAEtB,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,iBAAiB,CAAC,IAAI,2BAAY,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEvE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,qBAAqB,EAAE,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACnG,CAAC;IAES,4CAAY,GAAtB,UAAuB,CAAgB;QACnC,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAA4B,CAAC;QACvD,IAAM,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC3B,IAAM,eAAe,GAAG,QAAQ,KAAK,IAAI,CAAC;QAE1C,IAAI,eAAe,EAAE;YAAE,OAAO;SAAE;QAEhC,CAAC,CAAC,cAAc,EAAE,CAAC;QAEnB,IAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,wBAAwB,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC;QAE9F,IAAI,eAAe,EAAE;YACjB,eAAe,CAAC,KAAK,EAAE,CAAC;SAC3B;aAAM;YACH,IAAI,CAAC,KAAK,EAAE,CAAC;SAChB;IACL,CAAC;IAES,6CAAa,GAAvB,UAAwB,CAAgB;QACpC,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC;QACxC,IAAM,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC3B,IAAM,eAAe,GAAG,QAAQ,KAAK,IAAI,CAAC;QAE1C,QAAQ,CAAC,CAAC,OAAO,EAAE;YACf,KAAK,qBAAS,CAAC,MAAM,CAAC;YACtB,KAAK,qBAAS,CAAC,QAAQ;gBACnB,IAAI,CAAC,eAAe,EAAE;oBAClB,CAAC,CAAC,cAAc,EAAE,CAAC;iBACtB;YACL,KAAK,qBAAS,CAAC,QAAQ,CAAC;YACxB,KAAK,qBAAS,CAAC,SAAS;gBACpB,IAAI,eAAe,EAAE;oBAAE,OAAO;iBAAE;gBAChC,CAAC,CAAC,eAAe,EAAE,CAAC;YACxB,KAAK,qBAAS,CAAC,SAAS;gBACpB,IAAI,eAAe,EAAE;oBACjB,IAAI,IAAI,CAAC,eAAe,CAAC,0BAA0B,CAAC,IAAI,CAAC,EAAE;wBACvD,CAAC,CAAC,cAAc,EAAE,CAAC;qBACtB;iBACJ;gBACD,MAAM;YACV,KAAK,qBAAS,CAAC,UAAU;gBACrB,IAAI,CAAC,eAAe,EAAE;oBAClB,IAAI,CAAC,MAAM,EAAE,CAAC,KAAK,EAAE,CAAC;iBACzB;SACR;IACL,CAAC;IAES,yCAAS,GAAnB,UAAoB,CAAa;QAC7B,IAAM,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAE3B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,aAA4B,CAAC,EAAE;YAChD,IAAM,SAAS,GAAG,IAAI,CAAC,kBAAkB,EAAmB,CAAC;YAC7D,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,gBAAgB,CACvC,SAAS,CAAC,WAAW,EAAE,EACvB,IAAI,CAAC,SAAS,EAAE,CACnB,CAAC;SACL;IACL,CAAC;IAEO,mDAAmB,GAA3B;QAAA,iBAqBC;QApBG,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC;QAEvC,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,cAAc,EAAE;YACxC,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;YAElE,IAAI,IAAI,CAAC,yBAAyB,EAAE;gBAChC,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,UAAA,YAAY;oBAC5C,IAAI,YAAY,EAAE;wBACd,KAAI,CAAC,uBAAuB,CAAC,YAAY,CAAC,CAAC;wBAC3C,KAAI,CAAC,mBAAmB,EAAE,CAAC;qBAC9B;yBAAM;wBACH,KAAI,CAAC,UAAU,EAAE,CAAC;qBACrB;gBACL,CAAC,CAAC,CAAC;aACN;iBAAM;gBACH,IAAI,CAAC,UAAU,EAAE,CAAC;aACrB;SACJ;aAAM;YACH,IAAI,CAAC,UAAU,EAAE,CAAC;SACrB;IACL,CAAC;IAEO,oDAAoB,GAA5B;QACI,IAAM,cAAc,GAAG,IAAI,+BAAc,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAClF,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC;IAC3C,CAAC;IAEO,mDAAmB,GAA3B;QAAA,iBAWC;QAVG,IAAM,cAAc,GAAG,UAAC,kBAAsC;YAC1D,IAAM,WAAW,GAAG,KAAI,CAAC,kBAAkB,EAAE,CAAC,UAAU,CAAC,IAAI,EAAE,UAAA,MAAM,IAAI,OAAA,MAAM,CAAC,QAAQ,EAAE,EAAjB,CAAiB,CAAC,CAAC;YAC5F,KAAI,CAAC,oBAAoB,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;QAC/D,CAAC,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,eAAM,CAAC,oBAAoB,EAAE,cAAc,CAAC,CAAC;QAElF,IAAI,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;YAChD,cAAc,CAAC,IAAI,CAAC,CAAC;SACxB;IACL,CAAC;IAED,uCAAuC;IAC/B,gDAAgB,GAAxB;QACI,IAAI,CAAC,WAAW,CAAC,wBAAwB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,qBAAqB,EAAE,eAAe,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;IAC3H,CAAC;IAEO,gDAAgB,GAAxB;QACI,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,EAAE,eAAM,CAAC,0BAA0B,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC7G,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IAEO,6CAAa,GAArB;QACI,yBAAmB,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IAC1G,CAAC;IAEO,0CAAU,GAAlB;QACI,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,eAAM,CAAC,mBAAmB,EAAE,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACvG,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAChC,CAAC;IAEO,oDAAoB,GAA5B;QACI,IAAI,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,KAAK,GAAM,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,OAAI,CAAC;IACpE,CAAC;IAEO,uDAAuB,GAA/B,UAAgC,kBAAuC;QAAvE,iBA0BC;QAzBG,IAAM,WAAW,GAAG;YAChB,KAAI,CAAC,UAAU,EAAE,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC;QACtD,CAAC,CAAC;QAEF,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE;YACjB,WAAW,EAAE,CAAC;YACd,OAAO;SACV;QAED,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QAEjC,IAAM,oBAAoB,GAAG,kBAAkB,CAAC,MAAM,EAAE,CAAC;QAEzD,yBAAmB,CAAC,IAAI,CAAC,mBAAmB,EAAE,yBAAyB,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;QACrG,yBAAmB,CAAC,IAAI,CAAC,mBAAmB,EAAE,8BAA8B,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;QACzG,kBAAY,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;QAE9D,IAAM,KAAK,GAAG,uBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QAC/E,IAAI,CAAC,qBAAqB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAE9C,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;QAE3D,IAAI,kBAAkB,CAAC,gBAAgB,EAAE;YACrC,kBAAkB,CAAC,gBAAgB,EAAE,CAAC;SACzC;IACL,CAAC;IAEO,oDAAoB,GAA5B,UAA6B,QAA+C;QACxE,IAAI,CAAC,kBAAkB,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC7C,CAAC;IAEO,kDAAkB,GAA1B;QACI,OAAO,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;IACvE,CAAC;IAEO,yDAAyB,GAAjC;QACI,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC;QACvC,IAAI,yBAAiC,CAAC;QAEtC,IAAI,OAAO,MAAM,CAAC,MAAM,KAAK,QAAQ,EAAE;YACnC,sCAAsC;YACtC,yBAAyB,GAAG,qBAAqB,CAAC,2BAA2B,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SAChG;aAAM,IAAI,MAAM,CAAC,eAAe,EAAE;YAC/B,4FAA4F;YAC5F,0FAA0F;YAC1F,qDAAqD;SACxD;aAAM,IAAI,MAAM,CAAC,MAAM,KAAK,IAAI,EAAE;YAC/B,IAAM,qBAAqB,GAAG,+BAAc,CAAC,YAAY,CAAC,yBAAW,CAAC,eAAe,CAAC,CAAC;YACvF,yBAAyB,GAAG,qBAAqB,CAAC,CAAC,CAAC,2BAA2B,CAAC,CAAC,CAAC,4BAA4B,CAAC;SAClH;QAED,IAAM,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC;QACjG,IAAM,iBAAiB,GAAkB,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,MAAM,EAAE,QAAQ,EAAE,YAAY,CAAC,CAAC;QAErH,IAAM,MAAM,GAA0B;YAClC,GAAG,EAAE,IAAI,CAAC,OAAO;YACjB,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,YAAY,EAAE,iBAAiB;YAC/B,kBAAkB,EAAE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC;YACtD,oBAAoB,EAAE,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC;YAC1D,uBAAuB,EAAE,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC;YAChE,oBAAoB,EAAE,KAAK,CAAC,+CAA+C;SAC9E,CAAC;QAEF,qFAAqF;QACrF,mGAAmG;QACnG,IAAI,CAAC,oBAAoB,GAAG,MAAM,CAAC,6BAA6B,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,6BAA6B,CAAC,oBAAoB,CAAC,CAAC,CAAC,KAAK,CAAC;QAEvI,IAAI,OAAO,GAAG,IAAI,CAAC,oBAAoB,CAAC,0BAA0B,CAAC,MAAM,EAAE,MAAM,EAAE,yBAAyB,CAAC,CAAC;QAE9G,IAAI,CAAC,OAAO,EAAE;YACV,IAAM,eAAe,GAAG,IAAI,CAAC,2BAA2B,CAAC,MAAM,CAAC,CAAC;YACjE,IAAM,sBAAsB,GAAG,eAAe,IAAI,eAAe,CAAC,SAAS,IAAI,eAAe,CAAC,SAAS,CAAC,gBAAgB,CAAC;YAE1H,IAAI,sBAAsB,EAAE;gBACxB,IAAM,YAAY,GAAG,IAAI,CAAC,oBAAoB,CAAC,oCAAoC,CAC/E,+CAAsB,EACtB,MAAM,CACT,CAAC;gBAEF,OAAO,GAAG,eAAO,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;aAC3C;SACJ;QAED,OAAO,OAAO,CAAC;IACnB,CAAC;IAEO,mDAAmB,GAA3B;QACI,OAAO;YACH,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;YAC/B,GAAG,EAAE,IAAI,CAAC,OAAO;YACjB,SAAS,EAAE,IAAI,CAAC,SAAS;SAC5B,CAAC;IACN,CAAC;IAEO,2DAA2B,GAAnC,UAAoC,MAAc;QAC9C,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,CAAC,uBAAuB,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC;QAC1H,OAAO,iBAAiB,CAAC,CAAC,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;IAClE,CAAC;IAEO,0CAAU,GAAlB;QACI,kBAAY,CAAC,IAAI,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;IAC7C,CAAC;IAEO,kDAAkB,GAA1B;QACI,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC,UAAU,CAAC,IAAI,EAAE,UAAA,MAAM,IAAI,OAAA,MAAM,CAAC,QAAQ,EAAE,EAAjB,CAAiB,CAAC,CAAC;IACnF,CAAC;IAEO,oDAAoB,GAA5B,UAA6B,KAAU,EAAE,kBAAsC;QAC3E,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;YAAE,OAAO;SAAE;QAEhD,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,kBAAkB,CAAC,EAApD,CAAoD,CAAC,CAAC;IACtG,CAAC;IAEO,uDAAuB,GAA/B;QACI,OAAO,CAAC,IAAI,CAAC,iFAAiF;YAC1F,8FAA8F;YAC9F,mFAAmF,CAAC,CAAC;IAC7F,CAAC;IA/Sc,iDAA2B,GAA6B;QACnE,GAAG,EAAE,2BAA2B;QAChC,iBAAiB,EAAE,2BAA2B;QAE9C,MAAM,EAAE,8BAA8B;QACtC,oBAAoB,EAAE,8BAA8B;QAEpD,IAAI,EAAE,4BAA4B;QAClC,kBAAkB,EAAE,4BAA4B;QAEhD,IAAI,EAAE,4BAA4B;QAClC,kBAAkB,EAAE,4BAA4B;KACnD,CAAC;IAEa,8BAAQ,GACnB,qcAKO,CAAC;IAEqB;QAAhC,mBAAS,CAAC,oBAAoB,CAAC;qEAAgD;IAC/C;QAAhC,mBAAS,CAAC,oBAAoB,CAAC;qEAAgD;IAC7C;QAAlC,mBAAS,CAAC,sBAAsB,CAAC;uEAAoD;IAChE;QAArB,mBAAS,CAAC,SAAS,CAAC;0DAA0B;IACvB;QAAvB,mBAAS,CAAC,WAAW,CAAC;4DAA8B;IACzB;QAA3B,mBAAS,CAAC,eAAe,CAAC;gEAAsC;IACvC;QAAzB,mBAAS,CAAC,aAAa,CAAC;8DAAmC;IACxC;QAAnB,mBAAS,CAAC,OAAO,CAAC;wDAAwB;IAEP;QAAnC,kCAAW,CAAC,qBAAqB,CAAC;sEAA0C;IAC9C;QAA9B,kCAAW,CAAC,gBAAgB,CAAC;iEAAqC;IAC7B;QAArC,kCAAW,CAAC,uBAAuB,CAAC;wEAA4C;IA+QrF,4BAAC;CAjTD,AAiTC,CAjT0C,6CAAqB,GAiT/D;AAjTY,sDAAqB","file":"floatingFilterWrapper.js","sourcesContent":["import { Autowired } from '../../context/context';\nimport { IMenuFactory } from '../../interfaces/iMenuFactory';\nimport { Column } from '../../entities/column';\nimport { SetLeftFeature } from '../../rendering/features/setLeftFeature';\nimport { IFloatingFilterComp, IFloatingFilterParams } from './../floating/floatingFilter';\nimport { RefSelector } from '../../widgets/componentAnnotations';\nimport { GridOptionsWrapper } from '../../gridOptionsWrapper';\nimport { HoverFeature } from '../../headerRendering/hoverFeature';\nimport { Events, FilterChangedEvent } from '../../events';\nimport { ColumnHoverService } from '../../rendering/columnHoverService';\nimport { Promise } from '../../utils';\nimport { ColDef } from '../../entities/colDef';\nimport { IFilterComp, IFilterParams } from '../../interfaces/iFilter';\nimport { UserComponentFactory } from '../../components/framework/userComponentFactory';\nimport { GridApi } from '../../gridApi';\nimport { ColumnApi } from '../../columnController/columnApi';\nimport { FilterManager } from './../filterManager';\nimport { ReadOnlyFloatingFilter } from './provided/readOnlyFloatingFilter';\nimport { ModuleNames } from '../../modules/moduleNames';\nimport { ModuleRegistry } from '../../modules/moduleRegistry';\nimport { addOrRemoveCssClass, setDisplayed } from '../../utils/dom';\nimport { createIconNoSpan } from '../../utils/icon';\nimport { AbstractHeaderWrapper  } from '../../headerRendering/header/abstractHeaderWrapper';\nimport { Constants } from '../../constants';\nimport { Beans } from '../../rendering/beans';\nimport { HeaderRowComp } from '../../headerRendering/headerRowComp';\n\nexport class FloatingFilterWrapper extends AbstractHeaderWrapper {\n    private static filterToFloatingFilterNames: { [p: string]: string; } = {\n        set: 'agSetColumnFloatingFilter',\n        agSetColumnFilter: 'agSetColumnFloatingFilter',\n\n        number: 'agNumberColumnFloatingFilter',\n        agNumberColumnFilter: 'agNumberColumnFloatingFilter',\n\n        date: 'agDateColumnFloatingFilter',\n        agDateColumnFilter: 'agDateColumnFloatingFilter',\n\n        text: 'agTextColumnFloatingFilter',\n        agTextColumnFilter: 'agTextColumnFloatingFilter'\n    };\n\n    private static TEMPLATE = /* html */\n        `<div class=\"ag-header-cell\" role=\"presentation\" tabindex=\"-1\">\n            <div ref=\"eFloatingFilterBody\" role=\"columnheader\"></div>\n            <div class=\"ag-floating-filter-button\" ref=\"eButtonWrapper\" role=\"presentation\">\n                <button type=\"button\" aria-label=\"Open Filter Menu\" class=\"ag-floating-filter-button-button\" ref=\"eButtonShowMainFilter\" tabindex=\"-1\"></button>\n            </div>\n        </div>`;\n\n    @Autowired('columnHoverService') private columnHoverService: ColumnHoverService;\n    @Autowired('gridOptionsWrapper') private gridOptionsWrapper: GridOptionsWrapper;\n    @Autowired('userComponentFactory') private userComponentFactory: UserComponentFactory;\n    @Autowired('gridApi') private gridApi: GridApi;\n    @Autowired('columnApi') private columnApi: ColumnApi;\n    @Autowired('filterManager') private filterManager: FilterManager;\n    @Autowired('menuFactory') private menuFactory: IMenuFactory;\n    @Autowired('beans') protected beans: Beans;\n\n    @RefSelector('eFloatingFilterBody') private eFloatingFilterBody: HTMLElement;\n    @RefSelector('eButtonWrapper') private eButtonWrapper: HTMLElement;\n    @RefSelector('eButtonShowMainFilter') private eButtonShowMainFilter: HTMLElement;\n\n    protected readonly column: Column;\n    protected readonly pinned: string;\n\n    private suppressFilterButton: boolean;\n\n    private floatingFilterCompPromise: Promise<IFloatingFilterComp>;\n\n    constructor(column: Column, pinned: string) {\n        super(FloatingFilterWrapper.TEMPLATE);\n        this.column = column;\n        this.pinned = pinned;\n    }\n\n    protected postConstruct(): void {\n        super.postConstruct();\n\n        this.setupFloatingFilter();\n        this.setupWidth();\n        this.setupLeftPositioning();\n        this.setupColumnHover();\n        this.createManagedBean(new HoverFeature([this.column], this.getGui()));\n\n        this.addManagedListener(this.eButtonShowMainFilter, 'click', this.showParentFilter.bind(this));\n    }\n\n    protected onTabKeyDown(e: KeyboardEvent) {\n        const activeEl = document.activeElement as HTMLElement;\n        const eGui = this.getGui();\n        const wrapperHasFocus = activeEl === eGui;\n\n        if (wrapperHasFocus) { return; }\n\n        e.preventDefault();\n\n        const nextFocusableEl = this.focusController.findNextFocusableElement(eGui, null, e.shiftKey);\n\n        if (nextFocusableEl) {\n            nextFocusableEl.focus();\n        } else {\n            eGui.focus();\n        }\n    }\n\n    protected handleKeyDown(e: KeyboardEvent) {\n        const activeEl = document.activeElement;\n        const eGui = this.getGui();\n        const wrapperHasFocus = activeEl === eGui;\n\n        switch (e.keyCode) {\n            case Constants.KEY_UP:\n            case Constants.KEY_DOWN:\n                if (!wrapperHasFocus) {\n                    e.preventDefault();\n                }\n            case Constants.KEY_LEFT:\n            case Constants.KEY_RIGHT:\n                if (wrapperHasFocus) { return; }\n                e.stopPropagation();\n            case Constants.KEY_ENTER:\n                if (wrapperHasFocus) {\n                    if (this.focusController.focusFirstFocusableElement(eGui)) {\n                        e.preventDefault();\n                    }\n                }\n                break;\n            case Constants.KEY_ESCAPE:\n                if (!wrapperHasFocus) {\n                    this.getGui().focus();\n                }\n        }\n    }\n\n    protected onFocusIn(e: FocusEvent) {\n        const eGui = this.getGui();\n\n        if (!eGui.contains(e.relatedTarget as HTMLElement)) {\n            const headerRow = this.getParentComponent() as HeaderRowComp;\n            this.beans.focusController.setFocusedHeader(\n                headerRow.getRowIndex(),\n                this.getColumn()\n            );\n        }\n    }\n\n    private setupFloatingFilter(): void {\n        const colDef = this.column.getColDef();\n\n        if (colDef.filter && colDef.floatingFilter) {\n            this.floatingFilterCompPromise = this.getFloatingFilterInstance();\n\n            if (this.floatingFilterCompPromise) {\n                this.floatingFilterCompPromise.then(compInstance => {\n                    if (compInstance) {\n                        this.setupWithFloatingFilter(compInstance);\n                        this.setupSyncWithFilter();\n                    } else {\n                        this.setupEmpty();\n                    }\n                });\n            } else {\n                this.setupEmpty();\n            }\n        } else {\n            this.setupEmpty();\n        }\n    }\n\n    private setupLeftPositioning(): void {\n        const setLeftFeature = new SetLeftFeature(this.column, this.getGui(), this.beans);\n        this.createManagedBean(setLeftFeature);\n    }\n\n    private setupSyncWithFilter(): void {\n        const syncWithFilter = (filterChangedEvent: FilterChangedEvent) => {\n            const parentModel = this.getFilterComponent().resolveNow(null, filter => filter.getModel());\n            this.onParentModelChanged(parentModel, filterChangedEvent);\n        };\n\n        this.addManagedListener(this.column, Column.EVENT_FILTER_CHANGED, syncWithFilter);\n\n        if (this.filterManager.isFilterActive(this.column)) {\n            syncWithFilter(null);\n        }\n    }\n\n    // linked to event listener in template\n    private showParentFilter() {\n        this.menuFactory.showMenuAfterButtonClick(this.column, this.eButtonShowMainFilter, 'filterMenuTab', ['filterMenuTab']);\n    }\n\n    private setupColumnHover(): void {\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HOVER_CHANGED, this.onColumnHover.bind(this));\n        this.onColumnHover();\n    }\n\n    private onColumnHover(): void {\n        addOrRemoveCssClass(this.getGui(), 'ag-column-hover', this.columnHoverService.isHovered(this.column));\n    }\n\n    private setupWidth(): void {\n        this.addManagedListener(this.column, Column.EVENT_WIDTH_CHANGED, this.onColumnWidthChanged.bind(this));\n        this.onColumnWidthChanged();\n    }\n\n    private onColumnWidthChanged(): void {\n        this.getGui().style.width = `${this.column.getActualWidth()}px`;\n    }\n\n    private setupWithFloatingFilter(floatingFilterComp: IFloatingFilterComp): void {\n        const disposeFunc = () => {\n            this.getContext().destroyBean(floatingFilterComp);\n        };\n\n        if (!this.isAlive()) {\n            disposeFunc();\n            return;\n        }\n\n        this.addDestroyFunc(disposeFunc);\n\n        const floatingFilterCompUi = floatingFilterComp.getGui();\n\n        addOrRemoveCssClass(this.eFloatingFilterBody, 'ag-floating-filter-body', !this.suppressFilterButton);\n        addOrRemoveCssClass(this.eFloatingFilterBody, 'ag-floating-filter-full-body', this.suppressFilterButton);\n        setDisplayed(this.eButtonWrapper, !this.suppressFilterButton);\n\n        const eIcon = createIconNoSpan('filter', this.gridOptionsWrapper, this.column);\n        this.eButtonShowMainFilter.appendChild(eIcon);\n\n        this.eFloatingFilterBody.appendChild(floatingFilterCompUi);\n\n        if (floatingFilterComp.afterGuiAttached) {\n            floatingFilterComp.afterGuiAttached();\n        }\n    }\n\n    private parentFilterInstance(callback: (filterInstance: IFilterComp) => void): void {\n        this.getFilterComponent().then(callback);\n    }\n\n    private getFilterComponent(): Promise<IFilterComp> {\n        return this.filterManager.getFilterComponent(this.column, 'NO_UI');\n    }\n\n    private getFloatingFilterInstance(): Promise<IFloatingFilterComp> {\n        const colDef = this.column.getColDef();\n        let defaultFloatingFilterType: string;\n\n        if (typeof colDef.filter === 'string') {\n            // will be undefined if not in the map\n            defaultFloatingFilterType = FloatingFilterWrapper.filterToFloatingFilterNames[colDef.filter];\n        } else if (colDef.filterFramework) {\n            // If filterFramework, then grid is NOT using one of the provided filters, hence no default.\n            // Note: We could combine this with another part of the 'if' statement, however explicitly\n            // having this section makes the code easier to read.\n        } else if (colDef.filter === true) {\n            const setFilterModuleLoaded = ModuleRegistry.isRegistered(ModuleNames.SetFilterModule);\n            defaultFloatingFilterType = setFilterModuleLoaded ? 'agSetColumnFloatingFilter' : 'agTextColumnFloatingFilter';\n        }\n\n        const filterParams = this.filterManager.createFilterParams(this.column, this.column.getColDef());\n        const finalFilterParams: IFilterParams = this.userComponentFactory.createFinalParams(colDef, 'filter', filterParams);\n\n        const params: IFloatingFilterParams = {\n            api: this.gridApi,\n            column: this.column,\n            filterParams: finalFilterParams,\n            currentParentModel: this.currentParentModel.bind(this),\n            parentFilterInstance: this.parentFilterInstance.bind(this),\n            onFloatingFilterChanged: this.onFloatingFilterChanged.bind(this),\n            suppressFilterButton: false // This one might be overridden from the colDef\n        };\n\n        // this is unusual - we need a params value OUTSIDE the component the params are for.\n        // the params are for the floating filter component, but this property is actually for the wrapper.\n        this.suppressFilterButton = colDef.floatingFilterComponentParams ? !!colDef.floatingFilterComponentParams.suppressFilterButton : false;\n\n        let promise = this.userComponentFactory.newFloatingFilterComponent(colDef, params, defaultFloatingFilterType);\n\n        if (!promise) {\n            const filterComponent = this.getFilterComponentPrototype(colDef);\n            const getModelAsStringExists = filterComponent && filterComponent.prototype && filterComponent.prototype.getModelAsString;\n\n            if (getModelAsStringExists) {\n                const compInstance = this.userComponentFactory.createUserComponentFromConcreteClass(\n                    ReadOnlyFloatingFilter,\n                    params\n                );\n\n                promise = Promise.resolve(compInstance);\n            }\n        }\n\n        return promise;\n    }\n\n    private createDynamicParams(): any {\n        return {\n            column: this.column,\n            colDef: this.column.getColDef(),\n            api: this.gridApi,\n            columnApi: this.columnApi\n        };\n    }\n\n    private getFilterComponentPrototype(colDef: ColDef): { new(): any; } {\n        const resolvedComponent = this.userComponentFactory.lookupComponentClassDef(colDef, 'filter', this.createDynamicParams());\n        return resolvedComponent ? resolvedComponent.component : null;\n    }\n\n    private setupEmpty(): void {\n        setDisplayed(this.eButtonWrapper, false);\n    }\n\n    private currentParentModel(): any {\n        return this.getFilterComponent().resolveNow(null, filter => filter.getModel());\n    }\n\n    private onParentModelChanged(model: any, filterChangedEvent: FilterChangedEvent): void {\n        if (!this.floatingFilterCompPromise) { return; }\n\n        this.floatingFilterCompPromise.then(comp => comp.onParentModelChanged(model, filterChangedEvent));\n    }\n\n    private onFloatingFilterChanged(): void {\n        console.warn('ag-Grid: since version 21.x, how floating filters are implemented has changed. ' +\n            'Instead of calling params.onFloatingFilterChanged(), get a reference to the main filter via ' +\n            'params.parentFilterInstance() and then set a value on the parent filter directly.');\n    }\n}\n"]}